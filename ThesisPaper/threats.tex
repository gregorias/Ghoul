\chapter{Threats and defenses in DHT}
  Distributed hash table is a type of peer-to-peer system providing topology
  creation and maintainance protocols. They are typically designed for and
  tightly coupled with data storage protocols for key-value pairs, hence the
  hash-table part. DHTs suffer from various vulnerabilities, which mostly stem
  from two diffuclties:
  \begin{enumerate}
    \item Node identity is a virtual concept and lacks connection to the real
      world. DHTs as a distributed storage space rely on data and message
      redundancy and cohesiveness of the topology. Both are easily broken if an
      attacker may either arbitrarily place itself in the topology (Eclipse
      attack) or get as many nodes as it wants (Sybil attack).

    \item Each node only maintains a local view over the network, which does not
      provide enough context to detect and prevent any malicious behaviour.
  \end{enumerate}

\section{Eclipse attack}
  The main purpose behind attacks on DHTs are denial of service, either global
  or local, where we only want stop part of the network from working or
  subversion. In order to achieve those goals an attacker may want to increase
  its presence in the system by poisoning nodes' routing tables with entries
  pointing to colluding nodes. When a node's routing table is sufficiently
  filled with malicious nodes an attacker may begin the real attack. This
  process of routing table poisoning is called an eclipse attack, because when
  an attacker may eclipse part of the network by returning bogus answers to
  queries.

  \subsection{Prevention mechanisms}

  The general principles behind eclipse attack are: data and routing table
  redundancy, verifiability of routing table, lookup query redundancy.


\section{Sybil attack}
  DHTs routing mechanisms rely on the assumption that nodes are placed uniformly
  inside its key space and only a fraction of the network may fail, either due
  to churn or node failure. In case of eclipse attack or routing attack
  prevention mechanism they additionally assume that only a given portion of the
  network may be malicious. Those assumptions can be easily violated in an open
  DHT.

  Firstly, key generation is not verifiable. There is no way for a node to
  verify whether given key has been generated randomly. It is possible to use a
  statistical test to verify uniformity constraints, but they are often not
  enough to accuse specific node of malicious behaviour.

  Secondly, DHTs operate on an ephemeral sense of identity represented by a key.
  A Sybil attack happens when an attacker uses a single physical computer to
  represent multiple DHT nodes increasing his power without incurring additional
  cost. Since most protocols rely on honest nodes having a majority, a Sybil
  attack can shut down the system by even a modest attacker.

  Preventing a Sybil attack requires a gatekeeper or, more accurately, a
  bouncer. A protocol which prevents a single physical node to enter more than
  once and a way to throw out offenders. Achieving that in a fully distributed
  way is difficult. It is not possible to achieve adequate security if nodes
  only have access to their immediate surroundings. Such a limited view lacks
  necessary information to distinguish between bening and malicious behaviour.
  Additionally it's much easier to simply eclipse a node. Protocols that
  overcome this obstacle by sharing information globally do so at the cost of
  performance and scalibility. Such cost usually makes a DHT unpractical for
  larger networks. That's why most practical solutions make use of a central
  authority. This authority serves as a trusted entry point to the network, it
  generates signed random keys for newcomers and checks global constraints.

  Central authority has well-known drawbacks. Most of them stem from the fact
  that such authority represents a single point of failure. A failure of this
  authority may cause shut down of the network. Compromised authority is a
  security risk. It also acts negatively on scalability. Apart from
  technological disadvantages central authority is often an organizational
  problem. It forces an agent to maintain it in order to provide a service, this
  is done reluctantatly since it makes the agent responsible for maintaining the
  service and also Peer-to-Peer user community may be distrustful over
  centralized solution.

\subsection{Prevention mechanisms}

  The conclusion that only central authority solutions are practical for
  prevention of Sybil attacks was first deduced by \cite{dou02}, which also is
  the first paper studying this class of attacks \cite[p. 5]{urd11}

  [Tutaj jest praktycznie to co w \cite{urd11}]
  \subsubsection{Centralized gatekeeper}
  Castro et. al. \cite{cas02} agrees with \cite{dou02} conclusion and proposes
  using a set of central trusted authorities which certify random key and public
  key pair. They suggest adding an IP address to the certificate, so that the
  certificate would be binded to physical host. Unfortunately this solution is
  known to be problematic. First of all IP address can be spoofed and with IPv6
  privacy extensions changed al together. Second of all it would cause a problem
  for users behind NAT.

  Centralized gatekeeper gives much flexibility in implementing an
  authentication and sybil attack prevention scheme. For example there may be
  required a small monetary payment for entry into the DHT network or a
  computational puzzle may have to solved.

  \subsubsection{Distinction based on network footprint}

  Without centralized authority network peers would have to register new nodes
  in a distributed way. To distinguish distinct identities from same ones they
  may use network characterestics. Such characteristic are usually easy to check
  in the sense that any node may do it, giving low barrier of entry to the
  network, but it carries an assumption that they are unfalsifiable, which is
  not always the case.

  A simple ID calculation based on IP address and port number is proposed by
  Dinger and Hartensteing \cite[p. 6]{dou02}. They propose that a node would
  register $r$ Chord registration nodes whose position is calculated from hash
  of node's ID. If majority of registration nodes accept the new node then it is
  said to be accepted. A node registration fails if number nodes with given IP
  address exceeds a constant $a$. This solution requires all nodes to confirm
  validity of their neighbours.

  IP addresses may be spoofed and cause a problem for NAT users. Wang et. al.
  \cite[p. 7]{dou02} proposed adding router's IP and MAC address and RTT
  measurements between the node a designated set of landmarks. A similar idea
  may be found in Bazzi and Konjevod \cite[p. 7]{dou02} where nodes are put into
  $d$-dimensional space based on physical location of a node and a node are said
  to be distinct if their coordinates are far away enough.

  \subsubsection{Distinction based on social network}

  Another class of defenses uses a social network, a graph of trust
  relationships established by humans, to discover or mitigate a Sybil attack.
  In such defenses it is assumed that each node can verifiably identify itself
  as a node in the social network and that each edge forms a trust relationship
  which means that two people are friends and that they trust each other not to
  launch a Sybil attack. If any node was to launch a Sybil attack then the
  social network graph will exhibit special properties which may be detected. 

  Although such schemes show good performance, both in terms of application
  overhead and detectability, they are difficult to apply in real world
  applications.  [TODO aplikacja musi skądś ten graf wziąć co często jest
  niemile widziane lub niepraktyczne]

  SybilGuard \cite{hai06} mitigates effects of a Sybil attack by limiting the
  number of sybil nodes and recognized sybil groups. It defines the edges
  between honest nodes and sybil nodes as attack edges and notes that in a
  social graph there can be only few such edges. Then it allows a node to
  partition its neighbours into classes and guarantees with high probability
  that a number of classes that contain a Sybil node is limited by the number of
  attack edges. Although the scheme does not detect Sybil nodes it gives a
  guarantee that with a sufficient redundandancy an attacker will not be able to
  intercept a query or manipulate data.

  \subsubsection{Puzzles}

  SybilControl



\section{Content poisoning}
\section{Routing poisoning}

\section{Denial of Service}


\chapter{Technologies used in my application}

\section{Certificates, Web-of-trust, revocation}
\section{Distributed Key Generation?}
\section{Distributed robust random number generation}
\section{REST}
\section{SSL}

